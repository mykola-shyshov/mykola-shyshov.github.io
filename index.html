<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Гонка</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #2c3e50;
            font-family: Arial, sans-serif;
        }

        #gameContainer {
            position: relative;
        }

        #gameSvg {
            background-color: #34495e;
            border: 2px solid #ecf0f1;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        #gameStats {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 2px black;
        }

        #score {
            margin-bottom: 5px;
        }

        #coins {
            margin-bottom: 5px;
        }

        #gameOver {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        #startScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #2980b9;
        }

        .car {
            transition: transform 0.1s ease;
        }

        .road-line {
            animation: moveRoad 1s linear infinite;
        }

        @keyframes moveRoad {
            from { transform: translateY(0); }
            to { transform: translateY(20); }
        }

        .obstacle {
            transition: transform 0.1s ease;
        }

        .coin {
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .score-popup {
            position: absolute;
            color: #2ecc71;
            font-size: 20px;
            font-weight: bold;
            pointer-events: none;
            animation: scoreFloat 1s ease-out forwards;
        }

        @keyframes scoreFloat {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        .combo-text {
            position: absolute;
            color: #e74c3c;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .particle {
            position: absolute;
            pointer-events: none;
            animation: particleFade 0.5s ease-out forwards;
        }

        @keyframes particleFade {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        .explosion {
            position: absolute;
            pointer-events: none;
            animation: explode 0.5s ease-out forwards;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .trail {
            position: absolute;
            pointer-events: none;
            animation: trailFade 0.5s linear forwards;
        }

        @keyframes trailFade {
            0% { opacity: 0.5; }
            100% { opacity: 0; }
        }

        .power-up {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .game-container {
            position: relative;
            overflow: hidden;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #2c3e50, #34495e);
            z-index: -1;
        }
    </style>
</head>
<body>
    <div id="gameContainer" class="game-container">
        <div class="background"></div>
        <svg id="gameSvg" width="800" height="600" viewBox="0 0 800 600">
            <!-- Дорога -->
            <rect id="road" x="200" y="0" width="400" height="600" fill="#2c3e50"/>
            
            <!-- Розмітка дороги -->
            <g class="road-line">
                <line x1="400" y1="0" x2="400" y2="600" stroke="white" stroke-width="4" stroke-dasharray="20,20"/>
            </g>
            
            <!-- Машинка гравця -->
            <g id="playerCar" class="car" transform="translate(350, 500)">
                <!-- Кузов машинки -->
                <rect x="-25" y="-35" width="50" height="70" rx="5" fill="#e74c3c"/>
                <!-- Верхня частина -->
                <rect x="-20" y="-35" width="40" height="25" rx="3" fill="#c0392b"/>
                <!-- Вікна -->
                <rect x="-15" y="-30" width="30" height="15" rx="2" fill="#3498db"/>
                <!-- Фари -->
                <rect x="-20" y="30" width="10" height="5" rx="2" fill="#f1c40f"/>
                <rect x="10" y="30" width="10" height="5" rx="2" fill="#f1c40f"/>
                <!-- Колеса -->
                <circle cx="-20" cy="25" r="8" fill="#2c3e50"/>
                <circle cx="20" cy="25" r="8" fill="#2c3e50"/>
                <!-- Диски коліс -->
                <circle cx="-20" cy="25" r="4" fill="#95a5a6"/>
                <circle cx="20" cy="25" r="4" fill="#95a5a6"/>
                <!-- Бампер -->
                <rect x="-20" y="35" width="40" height="5" rx="2" fill="#c0392b"/>
            </g>

            <!-- Контейнер для перешкод -->
            <g id="obstaclesContainer"></g>

            <!-- Контейнер для монет -->
            <g id="coinsContainer"></g>
        </svg>

        <div id="gameStats">
            <div id="score">Очки: 0</div>
            <div id="coins">Монети: 0</div>
            <div id="combo">Комбо: x1</div>
            <div id="level">Рівень: 1</div>
        </div>

        <div id="startScreen">
            <h1>2D Гонка</h1>
            <p>Використовуйте стрілки вліво/вправо для керування</p>
            <p>Збирайте монети та уникайте перешкод!</p>
            <button id="startButton">Почати гру</button>
        </div>

        <div id="gameOver">
            <h2>Гра закінчена!</h2>
            <p>Ваш рахунок: <span id="finalScore">0</span></p>
            <p>Зібрані монети: <span id="finalCoins">0</span></p>
            <button id="restartButton">Грати знову</button>
        </div>
    </div>

    <script>
        // Базова структура гри
        const svg = document.getElementById('gameSvg');
        const playerCar = document.getElementById('playerCar');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOver');
        const startButton = document.getElementById('startButton');
        const restartButton = document.getElementById('restartButton');

        // Константи гри
        const GAME_WIDTH = 800;
        const GAME_HEIGHT = 600;
        const ROAD_WIDTH = 400;
        const ROAD_LEFT = 200;
        const CAR_WIDTH = 40;
        const CAR_HEIGHT = 60;
        const CAR_SPEED = 5;
        const OBSTACLE_SPEED = 3;
        const COIN_SPEED = 2;

        // Додаткові константи
        const OBSTACLE_TYPES = [
            { 
                width: 50, 
                height: 50, 
                color: '#e67e22',
                pattern: 'brick' // Цегляна стіна
            },
            { 
                width: 40, 
                height: 60, 
                color: '#9b59b6',
                pattern: 'wood' // Дерев'яна перешкода
            },
            { 
                width: 60, 
                height: 40, 
                color: '#1abc9c',
                pattern: 'metal' // Металева перешкода
            },
            { 
                width: 45, 
                height: 45, 
                color: '#e74c3c',
                pattern: 'rock' // Каміння
            },
            { 
                width: 55, 
                height: 55, 
                color: '#3498db',
                pattern: 'ice' // Крижана перешкода
            }
        ];
        const MAX_OBSTACLES = 5; // Збільшуємо максимальну кількість перешкод
        const MAX_COINS = 5;
        const SPAWN_INTERVAL = 1500; // Зменшуємо інтервал появи (було 2000)

        // Додаткові константи для ігрової логіки
        const COMBO_TIMEOUT = 2000; // 2 секунди для комбо
        const LEVEL_UP_SCORE = 33; // Зменшуємо очки для підвищення рівня (було 100)
        const MAX_LEVEL = 10;
        const SPEED_INCREASE_PER_LEVEL = 0.6; // Збільшуємо приріст швидкості (було 0.2)
        const OBSTACLE_SPAWN_INCREASE = 1.5; // Збільшуємо приріст частоти появи перешкод (було 0.5)

        // Додаткові константи для візуальних ефектів
        const PARTICLE_COUNT = 10;
        const TRAIL_LENGTH = 5;
        const POWER_UP_DURATION = 5000; // 5 секунд

        // Стан гри
        let gameStarted = false;
        let gameOver = false;
        let score = 0;
        let coinsCollected = 0;
        let carPosition = 350;
        let obstacles = [];
        let coins = [];
        let lastSpawnTime = 0;
        let gameSpeed = 1;
        let keys = {};

        // Розширений стан гри
        let level = 1;
        let combo = 1;
        let comboTimeout = null;
        let lastCoinTime = 0;
        let consecutiveCoins = 0;
        let totalDistance = 0;
        let obstacleSpawnRate = SPAWN_INTERVAL;

        // Функція створення текстури перешкоди
        function createObstaclePattern(type, width, height) {
            const pattern = document.createElementNS("http://www.w3.org/2000/svg", "pattern");
            pattern.setAttribute("id", `pattern-${type}`);
            pattern.setAttribute("patternUnits", "userSpaceOnUse");
            pattern.setAttribute("width", "20");
            pattern.setAttribute("height", "20");

            switch(type) {
                case 'brick':
                    // Цегляна текстура
                    for(let i = 0; i < 2; i++) {
                        for(let j = 0; j < 2; j++) {
                            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                            rect.setAttribute("x", i * 10);
                            rect.setAttribute("y", j * 10);
                            rect.setAttribute("width", "9");
                            rect.setAttribute("height", "9");
                            rect.setAttribute("fill", "#d35400");
                            rect.setAttribute("stroke", "#c0392b");
                            rect.setAttribute("stroke-width", "1");
                            pattern.appendChild(rect);
                        }
                    }
                    break;
                case 'wood':
                    // Дерев'яна текстура
                    for(let i = 0; i < 4; i++) {
                        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                        line.setAttribute("x1", "0");
                        line.setAttribute("y1", i * 5);
                        line.setAttribute("x2", "20");
                        line.setAttribute("y2", i * 5);
                        line.setAttribute("stroke", "#8e44ad");
                        line.setAttribute("stroke-width", "1");
                        pattern.appendChild(line);
                    }
                    break;
                case 'metal':
                    // Металева текстура
                    for(let i = 0; i < 2; i++) {
                        for(let j = 0; j < 2; j++) {
                            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                            circle.setAttribute("cx", i * 10 + 5);
                            circle.setAttribute("cy", j * 10 + 5);
                            circle.setAttribute("r", "3");
                            circle.setAttribute("fill", "#16a085");
                            circle.setAttribute("stroke", "#1abc9c");
                            circle.setAttribute("stroke-width", "1");
                            pattern.appendChild(circle);
                        }
                    }
                    break;
                case 'rock':
                    // Текстура каменю
                    for(let i = 0; i < 3; i++) {
                        for(let j = 0; j < 3; j++) {
                            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                            circle.setAttribute("cx", i * 7 + 3);
                            circle.setAttribute("cy", j * 7 + 3);
                            circle.setAttribute("r", "2");
                            circle.setAttribute("fill", "#c0392b");
                            pattern.appendChild(circle);
                        }
                    }
                    break;
                case 'ice':
                    // Крижана текстура
                    for(let i = 0; i < 2; i++) {
                        for(let j = 0; j < 2; j++) {
                            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                            path.setAttribute("d", `M${i*10},${j*10} L${i*10+10},${j*10+10} M${i*10+10},${j*10} L${i*10},${j*10+10}`);
                            path.setAttribute("stroke", "#2980b9");
                            path.setAttribute("stroke-width", "1");
                            pattern.appendChild(path);
                        }
                    }
                    break;
            }

            return pattern;
        }

        // Функція створення перешкоди
        function createObstacle() {
            const type = OBSTACLE_TYPES[Math.floor(Math.random() * OBSTACLE_TYPES.length)];
            const x = ROAD_LEFT + Math.random() * (ROAD_WIDTH - type.width);
            
            const obstacle = document.createElementNS("http://www.w3.org/2000/svg", "g");
            obstacle.setAttribute("class", "obstacle");
            obstacle.setAttribute("transform", `translate(${x}, 0)`);
            
            // Створюємо текстуру
            const pattern = createObstaclePattern(type.pattern, type.width, type.height);
            document.getElementById("gameSvg").appendChild(pattern);
            
            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", -type.width/2);
            rect.setAttribute("y", -type.height/2);
            rect.setAttribute("width", type.width);
            rect.setAttribute("height", type.height);
            rect.setAttribute("fill", `url(#pattern-${type.pattern})`);
            rect.setAttribute("stroke", type.color);
            rect.setAttribute("stroke-width", "2");
            
            obstacle.appendChild(rect);
            document.getElementById("obstaclesContainer").appendChild(obstacle);
            
            return {
                element: obstacle,
                x: x,
                y: 0,
                width: type.width,
                height: type.height
            };
        }

        // Функція створення монети
        function createCoin() {
            // Генеруємо випадкову позицію по X в межах дороги
            const x = ROAD_LEFT + 30 + Math.random() * (ROAD_WIDTH - 60);
            // Починаємо зверху екрану
            const y = 0;
            
            const coin = document.createElementNS("http://www.w3.org/2000/svg", "g");
            coin.setAttribute("class", "coin");
            coin.setAttribute("transform", `translate(${x}, ${y})`);
            
            const outerCircle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            outerCircle.setAttribute("cx", "0");
            outerCircle.setAttribute("cy", "0");
            outerCircle.setAttribute("r", "15");
            outerCircle.setAttribute("fill", "#f1c40f");
            
            const innerCircle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            innerCircle.setAttribute("cx", "0");
            innerCircle.setAttribute("cy", "0");
            innerCircle.setAttribute("r", "10");
            innerCircle.setAttribute("fill", "#f39c12");
            
            coin.appendChild(outerCircle);
            coin.appendChild(innerCircle);
            document.getElementById("coinsContainer").appendChild(coin);
            
            return {
                element: coin,
                x: x,
                y: y,
                radius: 15
            };
        }

        // Функція оновлення статистики
        function updateStats() {
            document.getElementById('score').textContent = `Очки: ${score}`;
            document.getElementById('coins').textContent = `Монети: ${coinsCollected}`;
            document.getElementById('combo').textContent = `Комбо: x${combo}`;
            document.getElementById('level').textContent = `Рівень: ${level}`;
        }

        // Функція створення спливаючого тексту
        function createScorePopup(x, y, text, color = '#2ecc71') {
            const popup = document.createElement('div');
            popup.className = 'score-popup';
            popup.style.left = `${x}px`;
            popup.style.top = `${y}px`;
            popup.style.color = color;
            popup.textContent = text;
            document.getElementById('gameContainer').appendChild(popup);
            
            setTimeout(() => popup.remove(), 1000);
        }

        // Функція оновлення комбо
        function updateCombo() {
            const currentTime = Date.now();
            if (currentTime - lastCoinTime < COMBO_TIMEOUT) {
                consecutiveCoins++;
                combo = Math.min(consecutiveCoins, 5); // Максимальне комбо x5
            } else {
                consecutiveCoins = 1;
                combo = 1;
            }
            lastCoinTime = currentTime;
            updateStats();
        }

        // Функція створення частинок
        function createParticles(x, y, color) {
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.backgroundColor = color;
                particle.style.width = '4px';
                particle.style.height = '4px';
                particle.style.borderRadius = '50%';
                
                const angle = (Math.random() * 360) * Math.PI / 180;
                const velocity = 2 + Math.random() * 2;
                const vx = Math.cos(angle) * velocity;
                const vy = Math.sin(angle) * velocity;
                
                particle.style.transform = `translate(${vx}px, ${vy}px)`;
                document.getElementById('gameContainer').appendChild(particle);
                
                setTimeout(() => particle.remove(), 500);
            }
        }

        // Функція створення ефекту вибуху
        function createExplosion(x, y, color) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = `${x}px`;
            explosion.style.top = `${y}px`;
            explosion.style.backgroundColor = color;
            explosion.style.width = '20px';
            explosion.style.height = '20px';
            explosion.style.borderRadius = '50%';
            document.getElementById('gameContainer').appendChild(explosion);
            
            setTimeout(() => explosion.remove(), 500);
        }

        // Функція створення сліду
        function createTrail(x, y) {
            const trail = document.createElement('div');
            trail.className = 'trail';
            trail.style.left = `${x}px`;
            trail.style.top = `${y}px`;
            trail.style.width = '4px';
            trail.style.height = '4px';
            trail.style.backgroundColor = '#e74c3c';
            trail.style.borderRadius = '50%';
            document.getElementById('gameContainer').appendChild(trail);
            
            setTimeout(() => trail.remove(), 500);
        }

        // Оптимізована функція перевірки зіткнень
        function checkCollisions() {
            const carLeft = carPosition - 25;
            const carRight = carPosition + 25;
            const carTop = 500 - 35;
            const carBottom = 500 + 35;

            // Оптимізована перевірка зіткнень з перешкодами
            for (let i = obstacles.length - 1; i >= 0; i--) {
                const obs = obstacles[i];
                if (Math.abs(obs.y - 500) < 50 &&
                    carLeft < obs.x + obs.width/2 &&
                    carRight > obs.x - obs.width/2) {
                    createExplosion(carPosition + 400, 500 + 300, '#e74c3c');
                    endGame();
                    return;
                }
            }

            // Оптимізована перевірка збору монет
            for (let i = coins.length - 1; i >= 0; i--) {
                const coin = coins[i];
                const distance = Math.sqrt(
                    Math.pow(coin.x - carPosition, 2) + 
                    Math.pow(coin.y - 500, 2)
                );
                
                if (distance < 40) {
                    updateCombo();
                    const points = 10 * combo;
                    score += points;
                    coinsCollected++;
                    
                    createParticles(coin.x + 400, coin.y + 300, '#f1c40f');
                    createScorePopup(coin.x + 400, coin.y + 300, `+${points}`);
                    
                    coin.element.remove();
                    coins.splice(i, 1);
                    updateStats();
                }
            }
        }

        // Функція перевірки підвищення рівня
        function checkLevelUp() {
            const newLevel = Math.floor(score / LEVEL_UP_SCORE) + 1;
            if (newLevel > level && newLevel <= MAX_LEVEL) {
                level = newLevel;
                // Збільшуємо швидкість більш агресивно
                gameSpeed = 1 + (level - 1) * SPEED_INCREASE_PER_LEVEL;
                // Збільшуємо частоту появи перешкод
                obstacleSpawnRate = Math.max(500, SPAWN_INTERVAL - (level - 1) * OBSTACLE_SPAWN_INCREASE);
                
                // Анімація підвищення рівня
                createScorePopup(
                    400,
                    300,
                    `Рівень ${level}!`,
                    '#e74c3c'
                );
                
                updateStats();
            }
        }

        // Оптимізована функція оновлення позицій
        function updatePositions(deltaTime) {
            // Оновлення позиції машинки з ефектом сліду
            if (keys['ArrowLeft'] && carPosition > ROAD_LEFT + CAR_WIDTH/2) {
                carPosition -= CAR_SPEED * gameSpeed;
                if (Math.random() < 0.3) { // 30% шанс створення сліду
                    createTrail(carPosition + 400, 500 + 300);
                }
            }
            if (keys['ArrowRight'] && carPosition < ROAD_LEFT + ROAD_WIDTH - CAR_WIDTH/2) {
                carPosition += CAR_SPEED * gameSpeed;
                if (Math.random() < 0.3) {
                    createTrail(carPosition + 400, 500 + 300);
                }
            }
            playerCar.setAttribute('transform', `translate(${carPosition}, 500)`);

            // Оновлення позицій перешкод
            for (let i = obstacles.length - 1; i >= 0; i--) {
                const obs = obstacles[i];
                obs.y += OBSTACLE_SPEED * gameSpeed;
                obs.element.setAttribute('transform', `translate(${obs.x}, ${obs.y})`);

                if (obs.y > GAME_HEIGHT) {
                    obs.element.remove();
                    obstacles.splice(i, 1);
                    score += 5 * level; // Збільшуємо очки за пройдену відстань в залежності від рівня
                    totalDistance += 1;
                    updateStats();
                }
            }

            // Оновлення позицій монет
            for (let i = coins.length - 1; i >= 0; i--) {
                const coin = coins[i];
                coin.y += COIN_SPEED * gameSpeed;
                coin.element.setAttribute('transform', `translate(${coin.x}, ${coin.y})`);

                if (coin.y > GAME_HEIGHT) {
                    coin.element.remove();
                    coins.splice(i, 1);
                }
            }

            // Створення нових перешкод та монет
            const currentTime = Date.now();
            if (currentTime - lastSpawnTime > obstacleSpawnRate) {
                if (obstacles.length < MAX_OBSTACLES) {
                    obstacles.push(createObstacle());
                }
                if (coins.length < MAX_COINS) {
                    const newCoin = createCoin();
                    const isOverlapping = coins.some(coin => 
                        Math.abs(coin.x - newCoin.x) < 30 && 
                        Math.abs(coin.y - newCoin.y) < 30
                    );
                    if (!isOverlapping) {
                        coins.push(newCoin);
                    }
                }
                lastSpawnTime = currentTime;
            }

            checkLevelUp();
        }

        // Оптимізована функція ініціалізації гри
        function initGame() {
            gameStarted = true;
            gameOver = false;
            score = 0;
            coinsCollected = 0;
            level = 1;
            combo = 1;
            consecutiveCoins = 0;
            totalDistance = 0;
            gameSpeed = 1;
            obstacleSpawnRate = SPAWN_INTERVAL;
            
            obstacles = [];
            coins = [];
            lastSpawnTime = 0;
            
            // Очищення всіх елементів
            document.getElementById("obstaclesContainer").innerHTML = "";
            document.getElementById("coinsContainer").innerHTML = "";
            document.querySelectorAll('pattern').forEach(p => p.remove());
            document.querySelectorAll('.particle, .explosion, .trail').forEach(el => el.remove());
            
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            updateStats();
            gameLoop();
        }

        // Функція завершення гри
        function endGame() {
            gameOver = true;
            gameStarted = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalCoins').textContent = coinsCollected;
            gameOverScreen.style.display = 'block';
        }

        // Оптимізований основний цикл гри
        let lastTime = 0;
        let frameCount = 0;
        let lastFpsUpdate = 0;
        let fps = 0;

        function gameLoop(timestamp) {
            if (!gameStarted) return;

            frameCount++;
            if (timestamp - lastFpsUpdate >= 1000) {
                fps = frameCount;
                frameCount = 0;
                lastFpsUpdate = timestamp;
            }

            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;

            // Пропускаємо кадри, якщо FPS занадто низький
            if (fps < 30 && frameCount % 2 === 0) {
                requestAnimationFrame(gameLoop);
                return;
            }

            updatePositions(deltaTime);
            checkCollisions();

            requestAnimationFrame(gameLoop);
        }

        // Оптимізація обробки подій
        let lastKeyPress = 0;
        const KEY_PRESS_INTERVAL = 16; // ~60 FPS

        window.addEventListener('keydown', (e) => {
            const currentTime = Date.now();
            if (currentTime - lastKeyPress >= KEY_PRESS_INTERVAL) {
                keys[e.key] = true;
                lastKeyPress = currentTime;
            }
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // Обробники подій
        startButton.addEventListener('click', initGame);
        restartButton.addEventListener('click', initGame);
    </script>
</body>
</html> 
